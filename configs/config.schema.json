{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://steelclock.local/config.schema.json",
  "title": "SteelClock Configuration",
  "description": "Configuration schema for SteelClock v2 - display manager for SteelSeries devices",
  "type": "object",
  "required": ["display", "widgets"],
  "properties": {
    "schema_version": {
      "type": "integer",
      "description": "Schema version (2 for this schema)",
      "const": 2
    },
    "game_name": {
      "type": "string",
      "description": "Internal game name for GameSense registration",
      "default": "STEELCLOCK"
    },
    "game_display_name": {
      "type": "string",
      "description": "Display name shown in SteelSeries GG",
      "default": "SteelClock"
    },
    "refresh_rate_ms": {
      "type": "integer",
      "description": "Display refresh rate in milliseconds. GameSense: min 100ms (10Hz). Direct: min 30ms (33Hz).",
      "minimum": 30,
      "default": 100
    },
    "unregister_on_exit": {
      "type": "boolean",
      "description": "Unregister from GameSense API on exit (may cause timeout)",
      "default": false
    },
    "deinitialize_timer_ms": {
      "type": "integer",
      "description": "Timeout for game deactivation after last event (1000-60000ms)",
      "minimum": 1000,
      "maximum": 60000
    },
    "backend": {
      "type": "string",
      "description": "Backend: 'gamesense' (requires SteelSeries GG), 'direct' (USB HID), 'any' (try gamesense, fallback to direct)",
      "enum": ["gamesense", "direct", "any"],
      "default": "any"
    },
    "direct_driver": {
      "type": "object",
      "description": "Direct USB HID driver configuration",
      "properties": {
        "vid": {
          "type": "string",
          "description": "USB Vendor ID in hex (e.g., '1038'). Auto-detect if omitted.",
          "pattern": "^[0-9A-Fa-f]{1,4}$"
        },
        "pid": {
          "type": "string",
          "description": "USB Product ID in hex (e.g., '1612'). Auto-detect if omitted.",
          "pattern": "^[0-9A-Fa-f]{1,4}$"
        },
        "interface": {
          "type": "string",
          "description": "USB interface identifier",
          "default": "mi_01"
        }
      }
    },
    "bundled_font_url": {
      "type": ["string", "null"],
      "description": "Custom URL for downloading bundled font (null = use default)",
      "default": null
    },
    "display": {
      "type": "object",
      "description": "Physical display configuration",
      "required": ["width", "height"],
      "properties": {
        "width": {
          "type": "integer",
          "description": "Display width in pixels",
          "default": 128
        },
        "height": {
          "type": "integer",
          "description": "Display height in pixels",
          "default": 40
        },
        "background": {
          "type": "integer",
          "description": "Display background color (0=black, 255=white)",
          "minimum": 0,
          "maximum": 255,
          "default": 0
        }
      }
    },
    "defaults": {
      "type": "object",
      "description": "Default values inherited by all widgets",
      "properties": {
        "colors": {
          "type": "object",
          "description": "Named colors that widgets can reference with @name syntax",
          "additionalProperties": {
            "type": "integer",
            "minimum": 0,
            "maximum": 255
          }
        },
        "text": { "$ref": "#/definitions/textObject" },
        "update_interval": {
          "type": "number",
          "description": "Default update interval in seconds",
          "minimum": 0.01,
          "default": 1.0
        }
      }
    },
    "widgets": {
      "type": "array",
      "description": "Array of widget configurations",
      "items": { "$ref": "#/definitions/widget" }
    }
  },
  "definitions": {
    "position": {
      "type": "object",
      "description": "Widget position and size",
      "required": ["x", "y", "w", "h"],
      "properties": {
        "x": { "type": "integer", "description": "X coordinate", "minimum": 0 },
        "y": { "type": "integer", "description": "Y coordinate" },
        "w": { "type": "integer", "description": "Width in pixels", "minimum": 1 },
        "h": { "type": "integer", "description": "Height in pixels", "minimum": 1 },
        "z": { "type": "integer", "description": "Z-order (higher = on top)", "default": 0 }
      }
    },
    "style": {
      "type": "object",
      "description": "Widget visual styling",
      "properties": {
        "background": {
          "type": "integer",
          "description": "Background color (-1=transparent, 0-255=grayscale)",
          "minimum": -1,
          "maximum": 255,
          "default": 0
        },
        "border": {
          "type": "integer",
          "description": "Border: -1=disabled, 0-255=enabled with that color",
          "minimum": -1,
          "maximum": 255,
          "default": -1
        },
        "padding": {
          "type": "integer",
          "description": "Padding from widget edges in pixels",
          "minimum": 0,
          "default": 0
        }
      }
    },
    "textObject": {
      "type": "object",
      "description": "Text rendering properties",
      "properties": {
        "format": { "type": "string", "description": "Format string (widget-specific)" },
        "font": { "type": ["string", "null"], "description": "Font name or TTF path (null = bundled font)", "default": null },
        "size": { "type": "integer", "description": "Font size in pixels", "minimum": 1, "default": 10 },
        "align": {
          "type": "object",
          "properties": {
            "h": { "type": "string", "enum": ["left", "center", "right"], "default": "center" },
            "v": { "type": "string", "enum": ["top", "center", "bottom"], "default": "center" }
          }
        },
        "unit": { "type": "string", "description": "Display unit (widget-specific)" }
      }
    },
    "autoHide": {
      "type": "object",
      "description": "Auto-hide behavior",
      "properties": {
        "enabled": { "type": "boolean", "description": "Enable auto-hide", "default": false },
        "timeout": { "type": "number", "description": "Seconds before hiding", "minimum": 0.1, "default": 2.0 },
        "on_silence": { "type": "boolean", "description": "Hide on audio silence (audio widgets)", "default": false },
        "silence_time": { "type": "number", "description": "Silence duration before hiding", "minimum": 0.1, "default": 2.0 }
      }
    },
    "widget": {
      "type": "object",
      "required": ["type", "position"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["clock", "cpu", "memory", "network", "disk", "keyboard", "keyboard_layout", "volume", "volume_meter", "audio_visualizer", "doom"]
        },
        "enabled": { "type": "boolean", "default": true },
        "position": { "$ref": "#/definitions/position" },
        "style": { "$ref": "#/definitions/style" },
        "update_interval": { "type": "number", "description": "Update interval in seconds", "minimum": 0.01 },
        "poll_interval": { "type": "number", "description": "Internal polling interval for volume/volume_meter widgets (seconds)", "minimum": 0.01, "default": 0.1 },
        "text": { "$ref": "#/definitions/textObject" },
        "auto_hide": { "$ref": "#/definitions/autoHide" }
      },
      "allOf": [
        {
          "if": { "properties": { "type": { "const": "clock" } }, "required": ["type"] },
          "then": {
            "properties": {
              "mode": { "type": "string", "description": "Display mode: text or analog clock face", "enum": ["text", "analog"], "default": "text" },
              "analog": {
                "type": "object",
                "description": "Analog clock face settings",
                "properties": {
                  "show_seconds": { "type": "boolean", "description": "Show seconds hand", "default": true },
                  "show_ticks": { "type": "boolean", "description": "Show hour tick marks", "default": true },
                  "colors": {
                    "type": "object",
                    "description": "Analog clock colors",
                    "properties": {
                      "face": { "type": "integer", "description": "Clock face outline color", "minimum": 0, "maximum": 255, "default": 255 },
                      "hour": { "type": "integer", "description": "Hour hand color", "minimum": 0, "maximum": 255, "default": 255 },
                      "minute": { "type": "integer", "description": "Minute hand color", "minimum": 0, "maximum": 255, "default": 255 },
                      "second": { "type": "integer", "description": "Second hand color", "minimum": 0, "maximum": 255, "default": 255 },
                      "ticks": { "type": "integer", "description": "Hour tick marks color", "minimum": 0, "maximum": 255, "default": 150 }
                    }
                  }
                }
              }
            }
          }
        },
        {
          "if": { "properties": { "type": { "const": "cpu" } }, "required": ["type"] },
          "then": {
            "properties": {
              "mode": { "type": "string", "description": "Display mode for CPU usage", "enum": ["text", "bar", "graph", "gauge"], "default": "bar" },
              "bar": {
                "type": "object",
                "description": "Bar mode settings",
                "properties": {
                  "direction": { "type": "string", "description": "Bar orientation", "enum": ["horizontal", "vertical"], "default": "horizontal" },
                  "border": { "type": "boolean", "description": "Draw border around bars", "default": false },
                  "colors": {
                    "type": "object",
                    "description": "Bar colors",
                    "properties": {
                      "fill": { "type": "integer", "description": "Bar fill color", "minimum": 0, "maximum": 255, "default": 255 }
                    }
                  }
                }
              },
              "graph": {
                "type": "object",
                "description": "Graph mode settings",
                "properties": {
                  "history": { "type": "integer", "description": "Number of data points to display", "minimum": 2, "default": 60 },
                  "filled": { "type": "boolean", "description": "Fill area under graph line", "default": true },
                  "colors": {
                    "type": "object",
                    "description": "Graph colors",
                    "properties": {
                      "fill": { "type": "integer", "description": "Graph fill/line color", "minimum": 0, "maximum": 255, "default": 255 }
                    }
                  }
                }
              },
              "gauge": {
                "type": "object",
                "description": "Gauge mode settings",
                "properties": {
                  "show_ticks": { "type": "boolean", "description": "Show gauge tick marks", "default": true },
                  "colors": {
                    "type": "object",
                    "description": "Gauge colors",
                    "properties": {
                      "fill": { "type": "integer", "description": "Gauge fill color", "minimum": 0, "maximum": 255, "default": 255 },
                      "arc": { "type": "integer", "description": "Gauge arc outline color", "minimum": 0, "maximum": 255, "default": 200 },
                      "needle": { "type": "integer", "description": "Gauge needle color", "minimum": 0, "maximum": 255, "default": 255 },
                      "ticks": { "type": "integer", "description": "Gauge tick marks color", "minimum": 0, "maximum": 255, "default": 150 }
                    }
                  }
                }
              },
              "per_core": {
                "type": "object",
                "description": "Per-core display settings",
                "properties": {
                  "enabled": { "type": "boolean", "description": "Show individual CPU cores", "default": false },
                  "margin": { "type": "integer", "description": "Margin between core bars in pixels", "minimum": 0, "default": 0 },
                  "border": { "type": "boolean", "description": "Draw border around each core bar", "default": false }
                }
              }
            }
          }
        },
        {
          "if": { "properties": { "type": { "const": "memory" } }, "required": ["type"] },
          "then": {
            "properties": {
              "mode": { "type": "string", "description": "Display mode for memory usage", "enum": ["text", "bar", "graph", "gauge"], "default": "bar" },
              "bar": {
                "type": "object",
                "description": "Bar mode settings",
                "properties": {
                  "direction": { "type": "string", "description": "Bar orientation", "enum": ["horizontal", "vertical"], "default": "horizontal" },
                  "border": { "type": "boolean", "description": "Draw border around bar", "default": false },
                  "colors": {
                    "type": "object",
                    "description": "Bar colors",
                    "properties": {
                      "fill": { "type": "integer", "description": "Bar fill color", "minimum": 0, "maximum": 255, "default": 255 }
                    }
                  }
                }
              },
              "graph": {
                "type": "object",
                "description": "Graph mode settings",
                "properties": {
                  "history": { "type": "integer", "description": "Number of data points to display", "minimum": 2, "default": 60 },
                  "filled": { "type": "boolean", "description": "Fill area under graph line", "default": true },
                  "colors": {
                    "type": "object",
                    "description": "Graph colors",
                    "properties": {
                      "fill": { "type": "integer", "description": "Graph fill/line color", "minimum": 0, "maximum": 255, "default": 255 }
                    }
                  }
                }
              },
              "gauge": {
                "type": "object",
                "description": "Gauge mode settings",
                "properties": {
                  "show_ticks": { "type": "boolean", "description": "Show gauge tick marks", "default": true },
                  "colors": {
                    "type": "object",
                    "description": "Gauge colors",
                    "properties": {
                      "fill": { "type": "integer", "description": "Gauge fill color", "minimum": 0, "maximum": 255, "default": 255 },
                      "arc": { "type": "integer", "description": "Gauge arc outline color", "minimum": 0, "maximum": 255, "default": 200 },
                      "needle": { "type": "integer", "description": "Gauge needle color", "minimum": 0, "maximum": 255, "default": 255 },
                      "ticks": { "type": "integer", "description": "Gauge tick marks color", "minimum": 0, "maximum": 255, "default": 150 }
                    }
                  }
                }
              }
            }
          }
        },
        {
          "if": { "properties": { "type": { "const": "network" } }, "required": ["type"] },
          "then": {
            "properties": {
              "mode": { "type": "string", "description": "Display mode for network I/O", "enum": ["text", "bar", "graph", "gauge"], "default": "bar" },
              "interface": { "type": ["string", "null"], "description": "Network interface name (null = auto-detect)", "default": null },
              "max_speed_mbps": { "type": "number", "description": "Maximum speed in Mbps for scaling", "default": 100 },
              "bar": {
                "type": "object",
                "description": "Bar mode settings",
                "properties": {
                  "direction": { "type": "string", "description": "Bar orientation", "enum": ["horizontal", "vertical"], "default": "horizontal" },
                  "border": { "type": "boolean", "description": "Draw border around bars", "default": false },
                  "colors": {
                    "type": "object",
                    "description": "Bar colors for RX/TX",
                    "properties": {
                      "rx": { "type": "integer", "description": "Receive (download) bar color", "minimum": 0, "maximum": 255, "default": 255 },
                      "tx": { "type": "integer", "description": "Transmit (upload) bar color", "minimum": 0, "maximum": 255, "default": 128 }
                    }
                  }
                }
              },
              "graph": {
                "type": "object",
                "description": "Graph mode settings",
                "properties": {
                  "history": { "type": "integer", "description": "Number of data points to display", "minimum": 2, "default": 60 },
                  "filled": { "type": "boolean", "description": "Fill area under graph lines", "default": true },
                  "colors": {
                    "type": "object",
                    "description": "Graph colors for RX/TX",
                    "properties": {
                      "rx": { "type": "integer", "description": "Receive (download) line color", "minimum": 0, "maximum": 255, "default": 255 },
                      "tx": { "type": "integer", "description": "Transmit (upload) line color", "minimum": 0, "maximum": 255, "default": 128 }
                    }
                  }
                }
              },
              "gauge": {
                "type": "object",
                "description": "Gauge mode settings (dual gauge: outer for RX, inner for TX)",
                "properties": {
                  "colors": {
                    "type": "object",
                    "description": "Gauge colors for RX/TX",
                    "properties": {
                      "rx": { "type": "integer", "description": "Receive (download) arc color", "minimum": 0, "maximum": 255, "default": 255 },
                      "tx": { "type": "integer", "description": "Transmit (upload) arc color", "minimum": 0, "maximum": 255, "default": 128 },
                      "rx_needle": { "type": "integer", "description": "Receive needle color", "minimum": 0, "maximum": 255, "default": 255 },
                      "tx_needle": { "type": "integer", "description": "Transmit needle color", "minimum": 0, "maximum": 255, "default": 180 }
                    }
                  }
                }
              }
            }
          }
        },
        {
          "if": { "properties": { "type": { "const": "disk" } }, "required": ["type"] },
          "then": {
            "properties": {
              "mode": { "type": "string", "description": "Display mode for disk I/O", "enum": ["text", "bar", "graph"], "default": "bar" },
              "disk": { "type": ["string", "null"], "description": "Disk/drive to monitor (auto-detect if omitted)" },
              "max_speed_mbps": { "type": "number", "description": "Maximum speed in MB/s for scaling (-1 for auto)", "default": -1 },
              "bar": {
                "type": "object",
                "description": "Bar mode settings",
                "properties": {
                  "direction": { "type": "string", "description": "Bar orientation", "enum": ["horizontal", "vertical"], "default": "horizontal" },
                  "border": { "type": "boolean", "description": "Draw border around bars", "default": false },
                  "colors": {
                    "type": "object",
                    "description": "Bar colors for read/write",
                    "properties": {
                      "read": { "type": "integer", "description": "Read bar color", "minimum": 0, "maximum": 255, "default": 255 },
                      "write": { "type": "integer", "description": "Write bar color", "minimum": 0, "maximum": 255, "default": 200 }
                    }
                  }
                }
              },
              "graph": {
                "type": "object",
                "description": "Graph mode settings",
                "properties": {
                  "history": { "type": "integer", "description": "Number of data points to display", "minimum": 2, "default": 60 },
                  "filled": { "type": "boolean", "description": "Fill area under graph lines", "default": true },
                  "colors": {
                    "type": "object",
                    "description": "Graph colors for read/write",
                    "properties": {
                      "read": { "type": "integer", "description": "Read line color", "minimum": 0, "maximum": 255, "default": 255 },
                      "write": { "type": "integer", "description": "Write line color", "minimum": 0, "maximum": 255, "default": 200 }
                    }
                  }
                }
              }
            }
          }
        },
        {
          "if": { "properties": { "type": { "const": "volume" } }, "required": ["type"] },
          "then": {
            "properties": {
              "mode": { "type": "string", "description": "Display mode for system volume", "enum": ["text", "bar", "gauge", "triangle"], "default": "bar" },
              "bar": {
                "type": "object",
                "description": "Bar mode settings",
                "properties": {
                  "direction": { "type": "string", "description": "Bar orientation", "enum": ["horizontal", "vertical"], "default": "horizontal" },
                  "border": { "type": "boolean", "description": "Draw border around bar", "default": false },
                  "colors": {
                    "type": "object",
                    "description": "Bar colors",
                    "properties": {
                      "fill": { "type": "integer", "description": "Bar fill color", "minimum": 0, "maximum": 255, "default": 255 }
                    }
                  }
                }
              },
              "gauge": {
                "type": "object",
                "description": "Gauge mode settings",
                "properties": {
                  "show_ticks": { "type": "boolean", "description": "Show gauge tick marks", "default": true },
                  "colors": {
                    "type": "object",
                    "description": "Gauge colors",
                    "properties": {
                      "arc": { "type": "integer", "description": "Gauge arc outline color", "minimum": 0, "maximum": 255, "default": 200 },
                      "needle": { "type": "integer", "description": "Gauge needle color", "minimum": 0, "maximum": 255, "default": 255 },
                      "ticks": { "type": "integer", "description": "Gauge tick marks color", "minimum": 0, "maximum": 255, "default": 150 }
                    }
                  }
                }
              },
              "triangle": {
                "type": "object",
                "description": "Triangle mode settings",
                "properties": {
                  "border": { "type": "boolean", "description": "Draw border around triangle", "default": false },
                  "colors": {
                    "type": "object",
                    "description": "Triangle colors",
                    "properties": {
                      "fill": { "type": "integer", "description": "Triangle fill color", "minimum": 0, "maximum": 255, "default": 255 }
                    }
                  }
                }
              }
            }
          }
        },
        {
          "if": { "properties": { "type": { "const": "volume_meter" } }, "required": ["type"] },
          "then": {
            "properties": {
              "mode": { "type": "string", "description": "Display mode for audio peak meter", "enum": ["text", "bar", "gauge"], "default": "bar" },
              "bar": {
                "type": "object",
                "description": "Bar mode settings",
                "properties": {
                  "direction": { "type": "string", "description": "Bar orientation", "enum": ["horizontal", "vertical"], "default": "horizontal" },
                  "colors": {
                    "type": "object",
                    "description": "Bar colors",
                    "properties": {
                      "fill": { "type": "integer", "description": "Bar fill color", "minimum": 0, "maximum": 255, "default": 255 },
                      "clipping": { "type": "integer", "description": "Clipping indicator color", "minimum": 0, "maximum": 255, "default": 200 }
                    }
                  }
                }
              },
              "gauge": {
                "type": "object",
                "description": "Gauge mode settings",
                "properties": {
                  "show_ticks": { "type": "boolean", "description": "Show gauge tick marks", "default": true },
                  "colors": {
                    "type": "object",
                    "description": "Gauge colors",
                    "properties": {
                      "arc": { "type": "integer", "description": "Gauge arc outline color", "minimum": 0, "maximum": 255, "default": 200 },
                      "needle": { "type": "integer", "description": "Gauge needle color", "minimum": 0, "maximum": 255, "default": 255 },
                      "ticks": { "type": "integer", "description": "Gauge tick marks color", "minimum": 0, "maximum": 255, "default": 150 },
                      "clipping": { "type": "integer", "description": "Clipping needle color", "minimum": 0, "maximum": 255, "default": 200 }
                    }
                  }
                }
              },
              "text": {
                "type": "object",
                "description": "Text mode settings",
                "properties": {
                  "format": { "type": "string", "description": "Text format string", "default": "%d%%" },
                  "font": { "type": ["string", "null"], "description": "Font file path (null = default)", "default": null },
                  "size": { "type": "integer", "description": "Font size in points", "minimum": 6, "maximum": 72, "default": 10 },
                  "align": {
                    "type": "object",
                    "description": "Text alignment",
                    "properties": {
                      "h": { "type": "string", "description": "Horizontal alignment", "enum": ["left", "center", "right"], "default": "center" },
                      "v": { "type": "string", "description": "Vertical alignment", "enum": ["top", "center", "bottom"], "default": "center" }
                    }
                  }
                }
              },
              "stereo": {
                "type": "object",
                "description": "Stereo channel settings",
                "properties": {
                  "enabled": { "type": "boolean", "description": "Show separate left/right channels", "default": false },
                  "divider": { "type": "integer", "description": "Divider line color between left/right channels (-1=disabled, 0-255=color)", "minimum": -1, "maximum": 255, "default": 64 }
                }
              },
              "metering": {
                "type": "object",
                "description": "Audio metering settings",
                "properties": {
                  "db_scale": { "type": "boolean", "description": "Use logarithmic dB scale instead of linear", "default": false },
                  "decay_rate": { "type": "number", "description": "Peak decay rate in dB/second", "minimum": 0.1, "default": 2.0 },
                  "silence_threshold": { "type": "number", "description": "Threshold below which audio is considered silent", "minimum": 0, "maximum": 1, "default": 0.01 }
                }
              },
              "peak": {
                "type": "object",
                "description": "Peak hold indicator settings",
                "properties": {
                  "enabled": { "type": "boolean", "description": "Show peak hold indicators", "default": true },
                  "hold_time": { "type": "number", "description": "Peak hold duration in seconds", "minimum": 0.1, "default": 1.0 }
                }
              },
              "clipping": {
                "type": "object",
                "description": "Clipping detection settings",
                "properties": {
                  "enabled": { "type": "boolean", "description": "Enable clipping detection", "default": true },
                  "threshold": { "type": "number", "description": "Clipping threshold (0.0-1.0)", "minimum": 0, "maximum": 1, "default": 0.99 }
                }
              }
            }
          }
        },
        {
          "if": { "properties": { "type": { "const": "audio_visualizer" } }, "required": ["type"] },
          "then": {
            "properties": {
              "mode": { "type": "string", "description": "Display mode: spectrum analyzer or oscilloscope", "enum": ["spectrum", "oscilloscope"], "default": "spectrum" },
              "spectrum": {
                "type": "object",
                "description": "Spectrum analyzer settings",
                "properties": {
                  "bars": { "type": "integer", "description": "Number of frequency bars", "minimum": 8, "maximum": 128, "default": 32 },
                  "scale": { "type": "string", "description": "Frequency scale distribution", "enum": ["logarithmic", "linear"], "default": "logarithmic" },
                  "style": { "type": "string", "description": "Rendering style", "enum": ["bars", "line"], "default": "bars" },
                  "smoothing": { "type": "number", "description": "Fall-off smoothing factor (0=instant, 1=max smooth)", "minimum": 0, "maximum": 1, "default": 0.7 },
                  "frequency_compensation": { "type": "boolean", "description": "Boost high frequencies for visual balance", "default": false },
                  "dynamic_scaling": {
                    "type": "object",
                    "description": "Automatic amplitude scaling",
                    "properties": {
                      "strength": { "type": "number", "description": "Scaling strength (0=disabled)", "minimum": 0, "maximum": 2, "default": 0 },
                      "window": { "type": "number", "description": "Rolling average window in seconds", "minimum": 0.1, "maximum": 5, "default": 0.5 }
                    }
                  },
                  "peak": {
                    "type": "object",
                    "description": "Peak hold indicator settings",
                    "properties": {
                      "enabled": { "type": "boolean", "description": "Show peak hold indicators on bars", "default": true },
                      "hold_time": { "type": "number", "description": "Peak hold duration in seconds", "minimum": 0.1, "default": 1.0 }
                    }
                  },
                  "colors": {
                    "type": "object",
                    "description": "Spectrum colors",
                    "properties": {
                      "fill": { "type": "integer", "description": "Bar/line fill color", "minimum": 0, "maximum": 255, "default": 255 },
                      "left": { "type": "integer", "description": "Left channel color (stereo_separated)", "minimum": 0, "maximum": 255, "default": 255 },
                      "right": { "type": "integer", "description": "Right channel color (stereo_separated)", "minimum": 0, "maximum": 255, "default": 200 }
                    }
                  }
                }
              },
              "oscilloscope": {
                "type": "object",
                "description": "Oscilloscope settings",
                "properties": {
                  "style": { "type": "string", "description": "Waveform rendering style", "enum": ["line", "filled"], "default": "line" },
                  "samples": { "type": "integer", "description": "Number of samples to display", "minimum": 32, "maximum": 512, "default": 128 },
                  "colors": {
                    "type": "object",
                    "description": "Oscilloscope colors",
                    "properties": {
                      "fill": { "type": "integer", "description": "Waveform color", "minimum": 0, "maximum": 255, "default": 255 },
                      "left": { "type": "integer", "description": "Left channel color (stereo_separated)", "minimum": 0, "maximum": 255, "default": 255 },
                      "right": { "type": "integer", "description": "Right channel color (stereo_separated)", "minimum": 0, "maximum": 255, "default": 200 }
                    }
                  }
                }
              },
              "channel": { "type": "string", "description": "Audio channel mode", "enum": ["mono", "stereo_combined", "stereo_separated"], "default": "stereo_combined" }
            }
          }
        },
        {
          "if": { "properties": { "type": { "const": "keyboard" } }, "required": ["type"] },
          "then": {
            "properties": {
              "indicators": {
                "type": "object",
                "description": "Keyboard lock indicator settings",
                "properties": {
                  "caps": {
                    "type": "object",
                    "description": "Caps Lock indicator",
                    "properties": {
                      "on": { "type": ["string", "null"], "description": "Text when Caps Lock is on (null = embedded glyph)", "default": null },
                      "off": { "type": ["string", "null"], "description": "Text when Caps Lock is off (null = embedded glyph)", "default": null }
                    }
                  },
                  "num": {
                    "type": "object",
                    "description": "Num Lock indicator",
                    "properties": {
                      "on": { "type": ["string", "null"], "description": "Text when Num Lock is on (null = embedded glyph)", "default": null },
                      "off": { "type": ["string", "null"], "description": "Text when Num Lock is off (null = embedded glyph)", "default": null }
                    }
                  },
                  "scroll": {
                    "type": "object",
                    "description": "Scroll Lock indicator",
                    "properties": {
                      "on": { "type": ["string", "null"], "description": "Text when Scroll Lock is on (null = embedded glyph)", "default": null },
                      "off": { "type": ["string", "null"], "description": "Text when Scroll Lock is off (null = embedded glyph)", "default": null }
                    }
                  }
                }
              },
              "layout": {
                "type": "object",
                "description": "Indicator layout settings",
                "properties": {
                  "spacing": { "type": "integer", "description": "Spacing between indicators in pixels", "minimum": 0, "default": 3 },
                  "separator": { "type": "string", "description": "Separator character between indicators", "default": "" }
                }
              },
              "colors": {
                "type": "object",
                "description": "Indicator colors",
                "properties": {
                  "on": { "type": "integer", "description": "Color when indicator is active", "minimum": 0, "maximum": 255, "default": 255 },
                  "off": { "type": "integer", "description": "Color when indicator is inactive", "minimum": 0, "maximum": 255, "default": 100 }
                }
              }
            }
          }
        },
        {
          "if": { "properties": { "type": { "const": "keyboard_layout" } }, "required": ["type"] },
          "then": {
            "properties": {
              "format": { "type": "string", "description": "Language code format: iso639-1 (EN), iso639-2 (ENG), or full (English)", "enum": ["iso639-1", "iso639-2", "full"], "default": "iso639-1" }
            }
          }
        },
        {
          "if": { "properties": { "type": { "const": "doom" } }, "required": ["type"] },
          "then": {
            "properties": {
              "wad": { "type": "string", "description": "WAD file name (auto-downloads doom1.wad if not found)", "default": "doom1.wad" },
              "bundled_wad_url": { "type": ["string", "null"], "description": "Custom URL for downloading DOOM shareware WAD (null = use default distro.ibiblio.org)", "default": null }
            }
          }
        }
      ]
    }
  }
}
